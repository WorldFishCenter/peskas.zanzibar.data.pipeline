<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Generate Geographic Regional Summaries of Fishery Data (Version 1) — create_geos_v1 • peskas.zanzibar.data.pipeline</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/IBM_Plex_Sans-0.4.10/font.css" rel="stylesheet"><link href="../deps/Fira_Mono-0.4.10/font.css" rel="stylesheet"><link href="../deps/Alegreya_Sans_SC-0.4.10/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Generate Geographic Regional Summaries of Fishery Data (Version 1) — create_geos_v1"><meta name="description" content="Creates geospatial representations of fishery metrics by aggregating landing
site data to regional levels along the Zanzibar coast. This simplified version
uses direct administrative district mappings instead of spatial proximity calculations,
making it more efficient for cases where district-to-region relationships are
already established."><meta property="og:description" content="Creates geospatial representations of fishery metrics by aggregating landing
site data to regional levels along the Zanzibar coast. This simplified version
uses direct administrative district mappings instead of spatial proximity calculations,
making it more efficient for cases where district-to-region relationships are
already established."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">peskas.zanzibar.data.pipeline</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">4.1.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Generate Geographic Regional Summaries of Fishery Data (Version 1)</h1>

      <div class="d-none name"><code>create_geos_v1.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Creates geospatial representations of fishery metrics by aggregating landing
site data to regional levels along the Zanzibar coast. This simplified version
uses direct administrative district mappings instead of spatial proximity calculations,
making it more efficient for cases where district-to-region relationships are
already established.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">create_geos_v1</span><span class="op">(</span>monthly_summaries_dat <span class="op">=</span> <span class="cn">NULL</span>, pars <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-monthly-summaries-dat">monthly_summaries_dat<a class="anchor" aria-label="anchor" href="#arg-monthly-summaries-dat"></a></dt>
<dd><p>A data frame containing monthly fishery metrics by district.
Required columns:</p><ul><li><p><code>district</code>: Character, name of the landing site district</p></li>
<li><p><code>date</code>: Date, month of the summary</p></li>
<li><p><code>mean_cpue_day</code>: Numeric, mean catch per unit effort per day</p></li>
<li><p><code>mean_rpue_day</code>: Numeric, mean revenue per unit effort per day</p></li>
<li><p><code>mean_price_kg</code>: Numeric, mean price per kilogram</p></li>
</ul></dd>


<dt id="arg-pars">pars<a class="anchor" aria-label="anchor" href="#arg-pars"></a></dt>
<dd><p>Configuration parameters list containing:</p><ul><li><p><code>storage$google$key</code>: Cloud storage provider key</p></li>
<li><p><code>storage$google$options_coasts</code>: Cloud storage options for coastal data</p></li>
</ul></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>NULL (invisible). The function uploads data to cloud storage as side effects:</p><ul><li><p>Parquet file: "zanzibar_monthly_summaries_map" containing regional summaries</p></li>
<li><p>GeoJSON file: "ZAN_regions_<a href="https://rdrr.io/r/base/Version.html" class="external-link">version</a>.geojson" containing regional boundaries</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function performs the following operations:</p><ol><li><p><strong>District-Region Mapping</strong>: Retrieves pre-defined administrative mappings
between districts and regions from site metadata</p></li>
<li><p><strong>Data Harmonization</strong>: Standardizes district names (e.g., "Chake chake" to
"Chake Chake") to ensure proper joining</p></li>
<li><p><strong>Regional Aggregation</strong>: Calculates monthly summary statistics for each
region by aggregating district-level data</p></li>
<li><p><strong>GeoJSON Export</strong>: Combines regional polygon geometries with summary
statistics and exports to cloud storage</p></li>
</ol><p><strong>Key Differences from create_geos()</strong>:</p><ul><li><p>Uses administrative mappings (ADM column) instead of spatial distance calculations</p></li>
<li><p>More efficient as it avoids complex spatial operations</p></li>
<li><p>Relies on pre-established district-region relationships in metadata</p></li>
<li><p>Handles district name inconsistencies automatically</p></li>
</ul><p><strong>Calculated Regional Metrics</strong> (using median values across districts in each region):</p><ul><li><p>Mean CPUE (Catch Per Unit Effort, kg per fisher per day)</p></li>
<li><p>Mean RPUE (Revenue Per Unit Effort, TZS per fisher per day)</p></li>
<li><p>Mean Price per kg of catch</p></li>
</ul><p><strong>Output Format</strong>:</p><ul><li><p>Regional summaries are exported as Parquet files to cloud storage</p></li>
<li><p>GeoJSON file containing regional boundaries is uploaded separately</p></li>
<li><p>Both files use standardized naming conventions with version information</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p><strong>Dependencies</strong>:</p><ul><li><p>Requires the <code>sf</code> package for reading and writing spatial data</p></li>
<li><p>Requires "ZAN_coast_regions.geojson" file in the package inst/ directory</p></li>
<li><p>Uses <code><a href="get_metadata.html">get_metadata()</a></code> function to retrieve district-region mappings</p></li>
<li><p>Uses <code><a href="add_version.html">add_version()</a></code> to append version information to filenames</p></li>
<li><p>Uses <code><a href="upload_parquet_to_cloud.html">upload_parquet_to_cloud()</a></code> and <code><a href="upload_cloud_file.html">upload_cloud_file()</a></code> for cloud storage</p></li>
</ul><p><strong>Data Processing Notes</strong>:</p><ul><li><p>District names are case-corrected (specifically "Chake chake" → "Chake Chake")</p></li>
<li><p>Regions are converted to lowercase in the output for consistency</p></li>
<li><p>Dates are formatted in ISO 8601 format (YYYY-MM-DDTHH:MM:SSZ)</p></li>
<li><p>All outputs include "country" = "zanzibar" for multi-country compatibility</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index">
<ul><li><p><code><a href="create_geos.html">create_geos()</a></code> for the spatial proximity-based version</p></li>
<li><p><code><a href="export_wf_data.html">export_wf_data()</a></code> which calls this function as part of the export workflow</p></li>
<li><p><code><a href="get_metadata.html">get_metadata()</a></code> for retrieving site and administrative information</p></li>
</ul></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># Load configuration</span></span></span>
<span class="r-in"><span><span class="va">pars</span> <span class="op">&lt;-</span> <span class="fu"><a href="read_config.html">read_config</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Get monthly summaries data</span></span></span>
<span class="r-in"><span><span class="va">monthly_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="download_parquet_from_cloud.html">download_parquet_from_cloud</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  prefix <span class="op">=</span> <span class="st">"wf_monthly_summaries"</span>,</span></span>
<span class="r-in"><span>  provider <span class="op">=</span> <span class="va">pars</span><span class="op">$</span><span class="va">storage</span><span class="op">$</span><span class="va">google</span><span class="op">$</span><span class="va">key</span>,</span></span>
<span class="r-in"><span>  options <span class="op">=</span> <span class="va">pars</span><span class="op">$</span><span class="va">storage</span><span class="op">$</span><span class="va">google</span><span class="op">$</span><span class="va">options</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create regional geospatial summaries</span></span></span>
<span class="r-in"><span><span class="fu">create_geos_v1</span><span class="op">(</span></span></span>
<span class="r-in"><span>  monthly_summaries_dat <span class="op">=</span> <span class="va">monthly_data</span>,</span></span>
<span class="r-in"><span>  pars <span class="op">=</span> <span class="va">pars</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Lorenzo Longobardi.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

