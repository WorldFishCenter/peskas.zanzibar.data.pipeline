% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/preprocessing.R
\name{preprocess_wf_surveys}
\alias{preprocess_wf_surveys}
\title{Pre-process and Combine WorldFish Surveys - Both Versions}
\usage{
preprocess_wf_surveys(log_threshold = logger::DEBUG, version = "v2")
}
\arguments{
\item{log_threshold}{The logging threshold to use. Default is logger::DEBUG.
See \code{logger::log_levels} for available options.}

\item{version}{Character string, deprecated. Function now processes both versions automatically.}
}
\value{
None; the function is used for its side effects.
}
\description{
Downloads and preprocesses raw structured WorldFish survey data from both version 1 and
version 2 sources, combines the results, and uploads a unified dataset. The function
automatically handles different survey structures and merges the processed data.
}
\details{
\strong{Processing Workflow:}
\enumerate{
\item Downloads and processes Version 1 surveys (if available)
\item Downloads and processes Version 2 surveys (if available)
\item Combines (binds) both datasets into a unified result
\item Uploads the combined dataset to cloud storage
}

\strong{Survey Version Differences:}
\itemize{
\item \strong{Version 1}: Single species field, nested length groups within species groups
\item \strong{Version 2}: Multiple species fields (species_TL, species_RF, etc.), separate
repeated group for fish >100cm (\verb{species_group/no_fish_by_length_group_100/})
}

The function uses \code{reshape_catch_data_v2()} which automatically detects survey version
based on column patterns and applies appropriate processing logic for each dataset.

\strong{Error Handling:}
If one version fails to process or is unavailable, the function continues with the
available data and logs warnings. The function only fails if both versions are unavailable.

Configurations are read from \code{conf.yml} with the following necessary parameters:

\if{html}{\out{<div class="sourceCode">}}\preformatted{surveys:
  wf_surveys:
    raw_surveys:
      file_prefix:
    preprocessed_surveys:
      file_prefix:
  wf_surveys_v2:
    raw_surveys:
      file_prefix:
storage:
  google:
    key:
    options:
      project:
      bucket:
      service_account_key:
}\if{html}{\out{</div>}}
}
\examples{
\dontrun{
# Process and combine both survey versions
preprocess_wf_surveys()

# With custom logging threshold
preprocess_wf_surveys(log_threshold = logger::INFO)
}

}
\seealso{
\code{\link{reshape_catch_data_v2}}, \code{\link{preprocess_general}}, \code{\link{preprocess_catch}}, \code{\link{process_version_data}}
}
\keyword{preprocessing}
\keyword{workflow}
