% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/merge-trips.R
\name{match_surveys_to_registry}
\alias{match_surveys_to_registry}
\title{Match Surveys to Device Registry via Fuzzy Matching}
\usage{
match_surveys_to_registry(
  surveys,
  registry,
  reg_threshold = 0.15,
  name_threshold = 0.25
)
}
\arguments{
\item{surveys}{Data frame with cleaned matching fields (registration_number_clean,
boat_name_clean, fisher_name_clean) and submission_id}

\item{registry}{Data frame with cleaned matching fields (registration_number_clean,
boat_name_clean, fisher_name_clean) and imei}

\item{reg_threshold}{Numeric. Maximum normalized Levenshtein distance (0-1)
for registration number matching. Default is 0.15.}

\item{name_threshold}{Numeric. Maximum normalized Levenshtein distance (0-1)
for boat name and fisher name matching. Default is 0.25.}
}
\value{
Data frame with the following columns:
\itemize{
\item submission_id: Survey identifier
\item imei: Matched device IMEI
\item n_fields_used: Number of non-NA fields available for matching (0-3)
\item n_fields_ok: Number of fields within threshold
\item match_ok: Logical indicating if at least one field matched (n_fields_ok >= 1)
}
}
\description{
Uses per-field Levenshtein distances to match surveys to a boat registry.
Each survey is matched to the registry entry with the most fields within
the specified distance thresholds.
}
\details{
The matching algorithm:
\enumerate{
\item Computes Levenshtein distance matrices between surveys and registry
for each field (registration, boat name, fisher name)
\item Normalizes distances by maximum string length to get values in \link{0,1}
\item For each survey, counts how many fields match each registry entry
(within thresholds)
\item Assigns survey to the registry entry with the most matching fields
\item Sets match_ok = TRUE if at least one field matched
}

Surveys with no non-NA fields return imei = NA and match_ok = FALSE.
}
\keyword{internal}
